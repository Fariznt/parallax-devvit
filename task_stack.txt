
test semantic node
adjust main.ts + modmail integration
reddit dev testing
add function header comments
publish


Future
0. catch errors in main.ts, log, and dont take action
1. support for posts, not just comments (image understanding? at least route title as a comment)
2. switch to yaml -> json conversion
3. check compatibility with other apis
4. consider migration to web-style when functional (high priority due to resume significance)
    allows UI for policy definition + UI action into reddit's interface for mods (ex. get trace) + webdev credibility
    + trace visibility
5. wrapping this is fundamental https://platform.openai.com/docs/guides/moderation?utm_source=chatgpt.com
6. incorporate use of post history
7. validate only one check per level (rn takes the cheapest one)
8. hella documentation
    more than one semantic node in any_of block is invalid. enforce through validation
    input threads need identifiers
    any of leaves downstream violations which may be interdependent
    -semantic node has not been stress tested for a reasonable limit on semantic nodes per policy
    (how much can one prompt handle) and it would be difficult/unreasonable to do so (theres always a stronger model,
    and the splitting depends on use case/semantic complexity) (a framework to help users do this would be nice in the future)
9. make address exist with line breaks
10. change whitelist blacklist to allow and deny
11. abstract away violation and nodeid init
12. add to validation that semantic_check is invalid if no deafult LLMConfig or referenced key is missing etc.
13. get rid of indexing in addresses... its unnecessary
14. make types location consistent (theres some in validation rn)
15 enforce this in validation:
  if (newDefChecks > 1) {
    throw new Error(
      `1> computation-deferring nodes are not permitted downstream an 'any_of' node
       or downstream a 'not' node followed by an 'all_of' node.
      A policy refactor is necessarily possible and cheaper by combining combinator logic 
      into a semantic_node.`
    )
  }
16. consider capping deferred checks such that past a threshold its split
and/or more evaluation modes like cross-content batching, 0 batching
17. support for how hard to think and maybe some sort of modding history testing pipeline

notes for me:
devvit settings set apiKey for setting apiKey
everything else set in mod tools
severity will be the closest upstream severity defined


figure out what im going to do in terms of tree representation. if decide against batch processing need to indicate in my architecture files
    these architectural decisions depend on the role this plays in the larger system
    perhaps: deterministic obvious removes (silent). removes + modmail. and non removes.
        i could keep the policyengine agnostic to this 3 way triage and do only 2 way. examine the trace, and llm involvement
        leads to modmail.
        So for r/izlam:
        final:
        all comments -> run through evaluation tree -> removed or not removed. if removed -> escalate to modmail with trace info
        report -> run through llm node -> remove or not removed. make removal sensitive/safe; if removed escalate to modmail else silent delete
        proto:
        all modqueue items -> run through llm -> trivial removed


        how can i deploy an automoderator 2nd phase version without writing much extra code that would be directly used in the final version?
            final version needs to be able to interact with modmail anyweayws and actually simply modmail event read + archive probably not too complicated, if feasible.
            i should rush early approval. then slowly work on building a proper engine that can be used elsewhere

